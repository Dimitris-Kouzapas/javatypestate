package buyer_seller;

import java.io.*;

class Main {
	
	public static void main(String[] args) {
		System.out.println("Hello World: I love coding!!");

		Socket socketSellerBuyer1 = new Socket();
		Socket socketSellerBuyer2 = new Socket();
		Socket socketBuyer1Buyer2 = new Socket();

		Seller seller = new Seller(socketSellerBuyer1, socketSellerBuyer2);
		Buyer1 buyer1 = new Buyer1(socketSellerBuyer1, socketBuyer1Buyer2);
		Buyer2 buyer2 = new Buyer2(socketSellerBuyer2, socketBuyer1Buyer2);

		socketSellerBuyer1.setEndpoints(seller, buyer1);
		socketSellerBuyer2.setEndpoints(seller, buyer2);
		socketBuyer1Buyer2.setEndpoints(buyer1, buyer2);

		buyer1.sendTitleToSeller("Alice's Adventures In Wonderland");
		String title = seller.receiveTitleFromBuyer1();
		seller.sendPriceToBuyer1("The book costs 80 pounds");
		buyer1.receivePriceFromSeller();
		buyer1.sendQuoteToBuyer2("42 pounds");
		String quote = buyer2.receiveQuoteFromBuyer1();
		
		switch (buyer2.sendToSellerBuyer1("AGREE").getEnum()) {
			case AgreementLabel.AGREE:
				buyer2.transferMoneyToSeller("42 pounds");
			case AgreementLabel.QUIT:
				System.out.println("The book is too expensive! I am not paying for it!");
		}

		switch (buyer1.receiveLabelFromBuyer2().getEnum()) {
			case AgreementLabel.AGREE:
				buyer1.transferMoneyToSeller("38 pounds");
			case AgreementLabel.QUIT:
				System.out.println("Buyer2 does not agree to the specified quote.");
		}

		switch (seller.receiveLabelFromBuyer2().getEnum()) {
			case AgreementLabel.AGREE:
				String money;
				money = seller.receiveMoneyFromBothBuyers();
			case AgreementLabel.QUIT:
				System.out.println("Bye bye!");
		}

		// // This is the protocol for buyer1
		// buyer1.receivePriceFromSeller();
		// buyer1.sendQuoteToBuyer2("42 pounds");
		// switch (buyer1.receiveLabelFromBuyer2().getEnum()) {
		// 	case AgreementLabel.AGREE:
		// 		buyer1.transferMoneyToSeller("38 pounds");
		// 	case AgreementLabel.QUIT:
		// 		System.out.println("Buyer2 does not agree to the specified quote.");
		// }
		
		// // This is the protocol for buyer2
		// // Buyer2 can choose between AGREE and QUIT
		// AgreementLabel sendAgreement = buyer2.sendToSellerBuyer1("AGREE");
		// switch (sendAgreement.getEnum()) {
		// 	case AgreementLabel.AGREE:
		// 		buyer2.transferMoneyToSeller("42 pounds");
		// 	case AgreementLabel.QUIT:
		// 		System.out.println("The book is too expensive! I am not paying for it!");
		// }

		// // This is the protocol for seller
		// seller.sendPriceToBuyer1("The book costs 80 pounds");
		// AgreementLabel recAgreement = seller.receiveLabelFromBuyer2();
		// switch (recAgreement.getEnum()) {
		// 	case AgreementLabel.AGREE:
		// 		String money;
		// 		money = seller.receiveMoneyFromBothBuyers();
		// 	case AgreementLabel.QUIT:
		// 		System.out.println("Bye bye!");
		// }
	}
}
