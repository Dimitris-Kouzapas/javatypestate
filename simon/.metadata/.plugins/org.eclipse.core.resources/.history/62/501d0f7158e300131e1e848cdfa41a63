package buyer_seller;

import java.util.LinkedList;

public class Socket {
	private LinkedList ep1_to_ep2 = new LinkedList();
	private LinkedList ep2_to_ep1 = new LinkedList();
	private Object endpoint1;
	private Object endpoint2;

	public void setEndpoints(Object endpoint1, Object endpoint2) {
		this.endpoint1 = endpoint1;
		this.endpoint2 = endpoint2;
	}

	public synchronized void send(Object from_endpoint, String message) {
		if (from_endpoint == endpoint1) {
			ep1_to_ep2.add(message);
		} else {
			ep2_to_ep1.add(message);
		}
	}

	public synchronized String receive(Object receiving_endpoint) {
    if (receiving_endpoint == endpoint1) {
    	while (ep2_to_ep1.isEmpty()) {
    		wait();
    	}
    	String message = (String)ep2_to_ep1.remove();
    	notifyAll();
        return message;
    } else {
    	while (ep1_to_ep2.isEmpty()) {
    		wait();
    	}
    	String message = (String)ep1_to_ep2.remove();
    	notifyAll();
        return message;
    }
 }

}